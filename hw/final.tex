\documentclass[12pt, leqno]{article}
\input{common}

\begin{document} \hdr{Final}

For the final, you are allowed to use texts, papers, or other
references (with citation).  You should not ask help from any other
person, whether inside or outside the class.  You should not worry if
you do not get all the answers; this is a sign that the test is doing
a proper job!  We reserve the right to ask follow-up questions in
person (e.g.~to determine whether it makes sense to assign partial
credit).  You may ask us to clarify ambiguities or perceived errors in
the prompt, but please do not ask for hints.

In addition to a PDF document detailing any derivation work,
you should submit a MATLAB file with your solutions, following
the format of the \verb|final_codes.m| file provided on the web page.
{\em Include tests}.  Clearly untested code (e.g.~code that fails to
execute) will receive at most half credit.

\begin{enumerate}
\item
  The following three convergence plots for finding $x_*$ such that
  $f(x_*) = 0$ were generated by a fixed point iteration
  $x_{k+1} = x_k - f(x_k)/f'(x_0)$, a Newton iteration
  $x_{k+1} = x_k - f(x_k)/f'(x_k)$, and a bisection solver.
  The function $f$ is smooth, and $f'(x_*) \neq 0$.
  Label each line with a method and {\em briefly} describe your
  reasoning.
  \begin{center}
  \begin{tikzpicture}
    \begin{semilogyaxis}[width=0.8\textwidth,height=3in,xlabel={$k$},ylabel={$|x_k-x_*|$}]
      \addplot table[x=k,y=a] {finalp1.dat}; \addlegendentry{A};
      \addplot table[x=k,y=b] {finalp1.dat}; \addlegendentry{B};
      \addplot table[x=k,y=c] {finalp1.dat}; \addlegendentry{C};
    \end{semilogyaxis}
  \end{tikzpicture}
  \end{center}

\item
  Suppose $A \in \bbR^{n \times n}$ is SPD.  Given $l$, $A^{-1} l$,
  and $A^{-1} b$, write a routine to perform the optimization
  \[
    \min_{x} \frac{1}{2} x^T A x - x^T b \quad \mbox{ s.t. } \quad l^Tx = 1.
  \]

\item
  Suppose $A \in \bbR^{n \times n}$ and $A = QR$ is given.  Write an
  $O(n^2)$ routine to compute the QR factorization $\hat{A} = \hat{Q}
  \hat{R}$ where $\hat{A} = AP$ and $P$ is a cyclic permutation
  ($P = \begin{bmatrix} e_n & e_1 & e_2 & \ldots & e_{n-1} \end{bmatrix}$).

\item
  Suppose $G : \bbR^2 \rightarrow \bbR^2$ is given, and define
  \[
    \tilde{G}(x) = \mu x + (1-\mu) G(x),
  \]
  where $\mu$ need not be positive.
  \begin{enumerate}
  \item Argue that a fixed point of $G$ is also a fixed point
    $\tilde{G}$.
  \item Suppose $x_* = G(x_*)$ and $G'(x_*)$ is symmetric with eigenvalues
    in the range $[\alpha, \beta]$ and $\beta < 1$.  Write a code to
    compute the optimal $\mu$ and a corresponding tight constant
    $\gamma < 1$ such that
    \[
      \|e_{k+1}\| \leq \gamma \|e_k\| + O(\|e_k\|^2)
    \]
    for starting vectors near enough to $x_*$.
  \end{enumerate}

\item
  Write a Newton iteration to solve the system
  \[
    x_{k-1} - (3-x_k/2) x_k + 2 x_{k+1} = 1,
  \]
  for $x_0 = x_{N+1} = 0$.  Use the initial guess
  $x_k = -1$ for $k=1, \ldots, N$.
  Your code should run in $O(N)$ time per iteration.
  You may use MATLAB sparse solvers.

\item
  Write a MATLAB code to perform the following optimization.
  \[
    \min_{\alpha} \sum_{j=d}^m \left|x_{j+1}-\sum_{i=0}^{d-1} \alpha_i x_{j-i}\right|^2
  \]
  subject to the constraint $\|\alpha\|_2 \leq \gamma$.

\end{enumerate}

\end{document}
